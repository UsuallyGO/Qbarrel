IF(WIN32)
    CMAKE_MINIMUM_REQUIRED(VERSION 2.4.6 FATAL_ERROR)
ELSE(WIN32)
    IF(APPLE)
        CMAKE_MINIMUM_REQUIRED(VERSION 2.4.6 FATAL_ERROR)
    ELSE(APPLE)
        CMAKE_MINIMUM_REQUIRED(VERSION 2.4.6 FATAL_ERROR)
    ENDIF(APPLE)
ENDIF(WIN32)

IF(COMMAND cmake_policy)
    CMAKE_POLICY(SET CMP0003 NEW)
ENDIF()

PROJECT(Qbarrel)

SET(QBARREL_INCLUDE ${PROJECT_SOURCE_DIR}/../include/)
INCLUDE_DIRECTORIES(${QBARREL_INCLUDE})

SET(QBARREL_SRC
    dict.c
    object.c
    string.c
    wrapevt.c
    evtselect.c)

SET(Qbarrellib "qbarrel")
ADD_LIBRARY(${Qbarrellib} SHARED ${QBARREL_SRC})

INSTALL(TARGETS ${Qbarrellib} RUNTIME DESTINATION bin
        LIBRARY DESTINATION lib
        ARCHIVE DESTINATION lib)
INSTALL(DIRECTORY ${PROJECT_SOURCE_DIR}/../include/
        DESTINATION ${CMAKE_INSTALL_PREFIX}/include
        DIRECTORY_PERMISSIONS PATTERN ".svn" EXCLUDE)
